<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Djinni-Town VR — Starter (WebXR)</title>
  <link rel="stylesheet" href="./asset/css/vr.css"/>
  <!-- Import map: pin modules so GitHub Pages works reliably -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.177.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.177.0/examples/jsm/",
      "@pixiv/three-vrm": "https://cdn.jsdelivr.net/npm/@pixiv/three-vrm@3.4.2/lib/three-vrm.module.min.js",
      "@pixiv/three-vrm-animation": "https://cdn.jsdelivr.net/npm/@pixiv/three-vrm-animation@3.4.2/+esm",
      "lil-gui": "https://cdn.jsdelivr.net/npm/lil-gui@0.20.0/+esm"
    }
  }
  </script>
</head>
<body>
  <div id="hud">
    <div class="row">
      <strong>Djinni-Town VR — Starter</strong>
      <span id="status">Booting…</span>
    </div>
    <div class="row small">
      • Put your VRM in <code>asset/models/</code> and wings FBX+PNGs in <code>asset/wings/</code>.<br/>
      • Open this page on Quest Browser (HTTPS) and press <em>Enter VR</em>.<br/>
      • Example URL params: <code>?vrm=asset/models/abbey.vrm&wings=asset/wings/Wing1415.fbx</code>
    </div>
    <div class="row small">
      <details>
        <summary>Quest controller help</summary>
        <ul>
          <li><b>A / X</b>: toggle Adjust/Lock</li>
          <li><b>Left Stick</b>: move X/Z</li>
          <li><b>Right Stick (X)</b>: rotate Y</li>
          <li><b>Right Trigger + Right Stick (Y)</b>: move Up/Down</li>
          <li><b>Grip + Right Stick (Y)</b>: scale</li>
        </ul>
      </details>
    </div>
  </div>

  <canvas id="app"></canvas>

  <!-- Dynamic import for better error messages if the module fails -->
  <script type="module">
    const status = (t)=>{ const el=document.getElementById('status'); if(el) el.textContent = t; console.log('[Boot]', t); };
    try {
      await import('./asset/js/main-webxr.js');
    } catch (e) {
      status('Failed to load main-webxr.js — ' + (e?.message || e));
      const pre = document.createElement('pre');
      pre.textContent = (e?.stack || String(e));
      pre.style.whiteSpace='pre-wrap'; pre.style.fontSize='11px';
      document.getElementById('hud').appendChild(pre);
    }
  </script>

  <noscript>This experience requires JavaScript and a WebXR-capable browser (Quest Browser).</noscript>
</body>
</html>
